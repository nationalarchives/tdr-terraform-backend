{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "iam",
      "Effect": "Allow",
      "Action": [
        "iam:AddRoleToInstanceProfile",
        "iam:AttachGroupPolicy",
        "iam:AttachRolePolicy",
        "iam:CreateGroup",
        "iam:CreateInstanceProfile",
        "iam:CreatePolicy",
        "iam:CreatePolicyVersion",
        "iam:CreatePolicyVersion",
        "iam:CreateRole",
        "iam:CreateServiceLinkedRole",
        "iam:DeleteAccountPasswordPolicy",
        "iam:DeleteGroup",
        "iam:DeleteInstanceProfile",
        "iam:DeletePolicy",
        "iam:DeletePolicyVersion",
        "iam:DeleteRole",
        "iam:DeleteRolePolicy",
        "iam:DetachGroupPolicy",
        "iam:DetachRolePolicy",
        "iam:Get*",
        "iam:List*",
        "iam:PassRole",
        "iam:PutRolePolicy",
        "iam:RemoveRoleFromInstanceProfile",
        "iam:TagRole",
        "iam:UpdateAccountPasswordPolicy",
        "iam:UpdateAssumeRolePolicy",
        "iam:UpdateGroup",
        "iam:UpdateRole"
      ],
      "Resource": [
        "arn:aws:iam::${account_id}:group/group/support",
        "arn:aws:iam::${account_id}:policy/consignmentapi_ecs_execution_policy_${environment}",
        "arn:aws:iam::${account_id}:policy/consignmentapi_ecs_task_policy_${environment}",
        "arn:aws:iam::${account_id}:policy/frontend_ecs_execution_policy_${environment}",
        "arn:aws:iam::${account_id}:policy/frontend_ecs_task_policy_${environment}",
        "arn:aws:iam::${account_id}:policy/keycloak_ecs_execution_policy_${environment}",
        "arn:aws:iam::${account_id}:policy/KeycloakECSExecutionPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/keycloak_ecs_task_policy_${environment}",
        "arn:aws:iam::${account_id}:policy/KeycloakECSTaskPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRApiUpdatePolicy",
        "arn:aws:iam::${account_id}:policy/TDRChecksumPolicy",
        "arn:aws:iam::${account_id}:policy/TDRCloudwatch${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRConfig${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRConsignmentApiAllowIAMAuthPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRConsignmentExportECSExecutionPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRConsignmentExportECSTaskPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRConsignmentExportPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRCreateDbUsersBastionPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRCreateDbUsersConsignmentapiPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRCreateKeycloakDbUserPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRCreateKeycloakDbUserNewPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRCustodian*",
        "arn:aws:iam::${account_id}:policy/TDRDbMigrationLambdaPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRDownloadFilesPolicy",
        "arn:aws:iam::${account_id}:policy/TDRExportApiAuthoriserLambdaPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRExportAPICloudwatchPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRExportAPIPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRFileFormatECSExecutionPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRFileFormatECSTaskPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRFileFormatLambdaPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRKeycloakECSTaskPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRKeycloakFlowlogPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRLogData${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRLogDataLambdaBase${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRNotificationsLambdaPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRServiceUnavailablePolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRSignCookiesLambdaPolicy",
        "arn:aws:iam::${account_id}:policy/TDRSignedCookiesAPICloudwatchPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRSignedCookiesAPIPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRSNSPublish${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRVpcFlowlogPolicy${title(environment)}",
        "arn:aws:iam::${account_id}:policy/TDRYaraAvPolicy",
        "arn:aws:iam::${account_id}:role/aws-service-role/*",
        "arn:aws:iam::${account_id}:role/BastionEC2Role${title(environment)}",
        "arn:aws:iam::${account_id}:role/consignmentapi_ecs_execution_role_${environment}",
        "arn:aws:iam::${account_id}:role/consignmentapi_ecs_task_role_${environment}",
        "arn:aws:iam::${account_id}:role/Custodian*",
        "arn:aws:iam::${account_id}:role/frontend_ecs_execution_role_${environment}",
        "arn:aws:iam::${account_id}:role/frontend_ecs_task_role_${environment}",
        "arn:aws:iam::${account_id}:role/keycloak_ecs_execution_role_${environment}",
        "arn:aws:iam::${account_id}:role/KeycloakECSExecutionRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/keycloak_ecs_task_role_${environment}",
        "arn:aws:iam::${account_id}:role/KeycloakECSTaskRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/keycloak_flowlog_role_${environment}",
        "arn:aws:iam::${account_id}:role/TDRApiUpdateRole",
        "arn:aws:iam::${account_id}:role/TDRChecksumRole",
        "arn:aws:iam::${account_id}:role/TDRCloudTrail${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRCognitoAuthorisedRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRConfig${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRConsignmentExportECSExecutionRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRConsignmentExportEcsTaskRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRConsignmentExportRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRCreateDbUsersBastionRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRCreateDbUsersConsignmentapiRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRCreateKeycloakDbUserRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRCreateKeycloakDbUserNewRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRDbMigrationLambdaRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRDownloadFilesRole",
        "arn:aws:iam::${account_id}:role/TDRExportApiAuthoriserLambdaRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRExportAPICloudwatchRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRExportAPIRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRFileFormatECSExecutionRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRFileFormatEcsTaskRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRFileFormatRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/tdr_flowlog_role_${environment}",
        "arn:aws:iam::${account_id}:role/TDRLogDataAssumeRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRLogDataCrossAccountRoleMgmt",
        "arn:aws:iam::${account_id}:role/TDRNotificationsLambdaRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRServiceUnavailableRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRSignCookiesLambdaRole",
        "arn:aws:iam::${account_id}:role/TDRSignedCookiesAPICloudwatchRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRSignedCookiesAPIRole${title(environment)}",
        "arn:aws:iam::${account_id}:role/TDRYaraAvRole"
      ]
    },
    {
      "Sid": "",
      "Effect": "Allow",
      "Action": [
        "iam:ListAccountAliases"
      ],
      "Resource": "*"
    }
  ]
}
